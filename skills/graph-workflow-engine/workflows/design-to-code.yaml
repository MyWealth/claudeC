id: design-to-code
name: ğŸ¨ è®¾è®¡ç¨¿è½¬ Vue3 ç»„ä»¶
description: åŸºäºç°æœ‰é¡¹ç›®ï¼Œç”Ÿæˆ Vue3 + Naive UI + SCSS ç»„ä»¶ä»£ç 

initial_context:
  framework: Vue 3
  ui_library: Naive UI
  styling: SCSS

graph:
  start_node: analyze_design

  nodes:
    # ========== ç¬¬ä¸€é˜¶æ®µï¼šå¹¶è¡Œåˆ†æ ==========
    - id: analyze_design
      type: action
      name: è®¾è®¡ç¨¿åˆ†æ
      description: æå–è®¾è®¡è¦ç´ ï¼Œè¯†åˆ« Naive UI å¯ç”¨ç»„ä»¶
      prompt: |
        åˆ†æä¸Šä¼ çš„è®¾è®¡ç¨¿ï¼Œæå–å…³é”®ä¿¡æ¯ï¼š

        1. **é¡µé¢ç±»å‹**ï¼šè¡¨å• / åˆ—è¡¨ / è¯¦æƒ… / å¼¹çª— / æ··åˆ
        2. **Naive UI ç»„ä»¶æ˜ å°„**ï¼š
           - æŒ‰é’® â†’ n-button
           - è¾“å…¥æ¡† â†’ n-input / n-input-number
           - é€‰æ‹©å™¨ â†’ n-select / n-cascader
           - æ—¥æœŸ â†’ n-date-picker
           - è¡¨æ ¼ â†’ n-data-table
           - å¡ç‰‡ â†’ n-card
           - æ ‡ç­¾é¡µ â†’ n-tabs
           - å¼¹çª— â†’ n-modal / n-drawer
           - æç¤º â†’ n-alert / n-message
           - åŠ è½½ â†’ n-spin / n-skeleton

        3. **å¸ƒå±€ç»“æ„**ï¼šGrid æ …æ ¼ / Flex å¸ƒå±€ / ä¾§è¾¹æ å¸ƒå±€
        4. **è‡ªå®šä¹‰ç»„ä»¶**ï¼šå“ªäº›éœ€è¦æ‰‹å†™ï¼ˆå¦‚ä¸šåŠ¡å¡ç‰‡ã€å›¾è¡¨ç­‰ï¼‰

        è¾“å‡ºåˆ†æç»“æœåˆ° context.analysis
      output_key: analysis
      confirm_before: true
      confirm_message: 'åˆ†æå®Œæˆï¼šæ£€æµ‹åˆ° {{analysis.naive_components.length}} ä¸ª Naive UI ç»„ä»¶å¯ç”¨ï¼Œ{{analysis.custom_components.length}} ä¸ªéœ€è‡ªå®šä¹‰ã€‚ç¡®è®¤ç»§ç»­ï¼Ÿ'
      next: [gen_structure, gen_styles]

    - id: gen_structure
      type: action
      name: ç”Ÿæˆç»„ä»¶ç»“æ„
      description: å¹¶è¡Œï¼šç”Ÿæˆ Vue æ¨¡æ¿å’Œé€»è¾‘
      dependencies: [analyze_design]
      prompt: |
        åŸºäºåˆ†æç»“æœï¼Œç”Ÿæˆ Vue 3 ç»„ä»¶ä»£ç ï¼ˆscript + templateï¼‰ã€‚

        ## è¦æ±‚
        - ä½¿ç”¨ `<script setup lang="ts">`
        - **æ— éœ€å¯¼å…¥ Naive UI ç»„ä»¶**ï¼ˆå‡è®¾å…¨å±€æ³¨å†Œï¼‰
        - ä½¿ç”¨ Naive UI ç»„ä»¶æ ‡ç­¾ï¼šn-button, n-card, n-form ç­‰
        - Props å’Œ Emits å®šä¹‰å®Œæ•´ç±»å‹
        - å¤æ‚é€»è¾‘æŠ½ç¦»ä¸º composable å‡½æ•°

        ## è¾“å‡ºæ ¼å¼
        ç”Ÿæˆ `ComponentName.vue` çš„å®Œæ•´ä»£ç ï¼ŒåŒ…æ‹¬ï¼š
        1. templateï¼ˆä½¿ç”¨ Naive UI ç»„ä»¶æ‹¼è£…ï¼‰
        2. scriptï¼ˆå“åº”å¼æ•°æ®ã€æ–¹æ³•ã€è®¡ç®—å±æ€§ï¼‰
        3. ç®€è¦è¯´æ˜å…³é”®é€»è¾‘

        è¾“å‡ºåˆ° context.vue_code
      output_key: vue_code
      next: merge_code

    - id: gen_styles
      type: action
      name: ç”Ÿæˆ SCSS æ ·å¼
      description: å¹¶è¡Œï¼šç”Ÿæˆæ ·å¼ä»£ç 
      dependencies: [analyze_design]
      prompt: |
        ç”Ÿæˆç»„ä»¶çº§ SCSS ä»£ç ã€‚

        ## è§„èŒƒ
        - ä½¿ç”¨ `<style scoped lang="scss">`
        - å¼•ç”¨ç°æœ‰å˜é‡ï¼ˆå¦‚ `$primary-color`, `$border-radius` ç­‰ï¼‰
        - è¦†ç›– Naive UI æ ·å¼ä½¿ç”¨ `:deep()` é€‰æ‹©å™¨
        - BEM å‘½åï¼š`.component-name__element--modifier`

        ## è¾“å‡ºå†…å®¹
        1. SCSS ä»£ç å—
        2. ä½¿ç”¨çš„å˜é‡æ¸…å•ï¼ˆæ–¹ä¾¿ç¡®è®¤ä¸ç°æœ‰é¡¹ç›®ä¸€è‡´ï¼‰

        è¾“å‡ºåˆ° context.scss_code
      output_key: scss_code
      next: merge_code

    # ========== ç¬¬äºŒé˜¶æ®µï¼šåˆå¹¶è¾“å‡º ==========
    - id: merge_code
      type: action
      name: åˆå¹¶ä»£ç 
      merge_strategy: all
      description: åˆå¹¶ Vue å’Œ SCSS ç”Ÿæˆå®Œæ•´æ–‡ä»¶
      prompt: |
        åˆå¹¶ç”Ÿæˆæœ€ç»ˆä»£ç æ–‡ä»¶ï¼š

        ```vue
        <!-- {{analysis.component_name || 'Component'}}.vue -->
        <template>
        {{vue_code.template}}
        </template>

        <script setup lang="ts">
        {{vue_code.script}}
        </script>

        <style scoped lang="scss">
        {{scss_code}}
        </style>
        ```

        åŒæ—¶ç”Ÿæˆï¼š
        - æ–‡ä»¶å­˜æ”¾å»ºè®®è·¯å¾„ï¼ˆå¦‚ `src/views/` æˆ– `src/components/`ï¼‰
        - çˆ¶ç»„ä»¶è°ƒç”¨ç¤ºä¾‹
      confirm_before: true
      confirm_message: ç»„ä»¶ä»£ç å·²ç”Ÿæˆï¼Œæ˜¯å¦ç›´æ¥å†™å…¥æ–‡ä»¶æˆ–ä»…é¢„è§ˆï¼Ÿ
      next: user_decision

    - id: user_decision
      type: decision
      name: æ“ä½œé€‰æ‹©
      prompt: |
        ä»£ç å·²å‡†å¤‡å°±ç»ªï¼Œè¯·é€‰æ‹©æ“ä½œï¼š
      options:
        - id: preview
          label: ğŸ‘€ ä»…é¢„è§ˆï¼ˆå¤åˆ¶ä½¿ç”¨ï¼‰
          next: end

        - id: write
          label: ğŸ’¾ å†™å…¥æ–‡ä»¶ï¼ˆæä¾›è·¯å¾„ï¼‰
          next: write_file

        - id: modify
          label: âœï¸ è°ƒæ•´åå†ç”Ÿæˆ
          next: analyze_design

    - id: write_file
      type: input
      name: ç¡®è®¤æ–‡ä»¶è·¯å¾„
      inputs:
        - key: file_path
          label: æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰
          type: text
          default: src/components/DesignComponent.vue
      next: final_check

    - id: final_check
      type: action
      name: ä»£ç å®¡æŸ¥
      prompt: |
        æœ€ç»ˆæ£€æŸ¥æ¸…å•ï¼š

        âœ… ä½¿ç”¨ Naive UI ç»„ä»¶æ— éœ€ importï¼ˆå…¨å±€å¯ç”¨ï¼‰
        âœ… TypeScript ç±»å‹å®šä¹‰å®Œæ•´
        âœ… SCSS å˜é‡å¼•ç”¨æ­£ç¡®
        âœ… å“åº”å¼å¸ƒå±€é€‚é…
        âœ… æ—  console.log æ®‹ç•™

        æ–‡ä»¶å°†å†™å…¥ï¼š{{file_path}}
      confirm_before: true
      next: end

  edges:
    - from: '*'
      command: /back
      action: rollback
